{
  "_format": "hh-sol-artifact-1",
  "contractName": "AuditTrail",
  "sourceName": "contracts/AuditTrail.sol",
  "abi": [
    {
      "inputs": [],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "owner",
          "type": "address"
        }
      ],
      "name": "OwnableInvalidOwner",
      "type": "error"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        }
      ],
      "name": "OwnableUnauthorizedAccount",
      "type": "error"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "enum AuditTrail.EventType",
          "name": "eventType",
          "type": "uint8"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "agent",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "uint8",
          "name": "riskScore",
          "type": "uint8"
        }
      ],
      "name": "AuditEventLogged",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "address",
          "name": "previousOwner",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "OwnershipTransferred",
      "type": "event"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "agentEvents",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "name": "auditLog",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        },
        {
          "internalType": "enum AuditTrail.EventType",
          "name": "eventType",
          "type": "uint8"
        },
        {
          "internalType": "address",
          "name": "agent",
          "type": "address"
        },
        {
          "internalType": "address",
          "name": "target",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "value",
          "type": "uint256"
        },
        {
          "internalType": "string",
          "name": "description",
          "type": "string"
        },
        {
          "internalType": "uint8",
          "name": "riskScore",
          "type": "uint8"
        },
        {
          "internalType": "uint256",
          "name": "timestamp",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "eventCount",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "_agent",
          "type": "address"
        }
      ],
      "name": "getAgentEvents",
      "outputs": [
        {
          "internalType": "uint256[]",
          "name": "",
          "type": "uint256[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "_id",
          "type": "uint256"
        }
      ],
      "name": "getEvent",
      "outputs": [
        {
          "components": [
            {
              "internalType": "uint256",
              "name": "id",
              "type": "uint256"
            },
            {
              "internalType": "enum AuditTrail.EventType",
              "name": "eventType",
              "type": "uint8"
            },
            {
              "internalType": "address",
              "name": "agent",
              "type": "address"
            },
            {
              "internalType": "address",
              "name": "target",
              "type": "address"
            },
            {
              "internalType": "uint256",
              "name": "value",
              "type": "uint256"
            },
            {
              "internalType": "string",
              "name": "description",
              "type": "string"
            },
            {
              "internalType": "uint8",
              "name": "riskScore",
              "type": "uint8"
            },
            {
              "internalType": "uint256",
              "name": "timestamp",
              "type": "uint256"
            }
          ],
          "internalType": "struct AuditTrail.AuditEvent",
          "name": "",
          "type": "tuple"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "_count",
          "type": "uint256"
        }
      ],
      "name": "getRecentEvents",
      "outputs": [
        {
          "components": [
            {
              "internalType": "uint256",
              "name": "id",
              "type": "uint256"
            },
            {
              "internalType": "enum AuditTrail.EventType",
              "name": "eventType",
              "type": "uint8"
            },
            {
              "internalType": "address",
              "name": "agent",
              "type": "address"
            },
            {
              "internalType": "address",
              "name": "target",
              "type": "address"
            },
            {
              "internalType": "uint256",
              "name": "value",
              "type": "uint256"
            },
            {
              "internalType": "string",
              "name": "description",
              "type": "string"
            },
            {
              "internalType": "uint8",
              "name": "riskScore",
              "type": "uint8"
            },
            {
              "internalType": "uint256",
              "name": "timestamp",
              "type": "uint256"
            }
          ],
          "internalType": "struct AuditTrail.AuditEvent[]",
          "name": "",
          "type": "tuple[]"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "getTotalEvents",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "enum AuditTrail.EventType",
          "name": "_type",
          "type": "uint8"
        },
        {
          "internalType": "address",
          "name": "_agent",
          "type": "address"
        },
        {
          "internalType": "address",
          "name": "_target",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "_value",
          "type": "uint256"
        },
        {
          "internalType": "string",
          "name": "_description",
          "type": "string"
        },
        {
          "internalType": "uint8",
          "name": "_riskScore",
          "type": "uint8"
        }
      ],
      "name": "logEvent",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "owner",
      "outputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "renounceOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "transferOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "bytecode": "0x608060405234801561001057600080fd5b50338061003757604051631e4fbdf760e01b81526000600482015260240160405180910390fd5b61004081610046565b50610096565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b610f61806100a56000396000f3fe608060405234801561001057600080fd5b50600436106100a95760003560e01c8063715018a611610071578063715018a61461013857806371be2e4a146101425780638da5cb5b1461014b578063a138e38f14610166578063f22ac6f114610179578063f2fde38b146101a057600080fd5b806361606940146100ae578063649ad632146100c5578063680294eb146100e55780636d1884e0146100f857806370e9e62314610118575b600080fd5b6001545b6040519081526020015b60405180910390f35b6100d86100d33660046109e7565b6101b3565b6040516100bc9190610a09565b6100b26100f3366004610a4d565b61021f565b61010b610106366004610a77565b610250565b6040516100bc9190610b91565b61012b610126366004610a77565b6103aa565b6040516100bc9190610ba4565b6101406105c0565b005b6100b260025481565b6000546040516001600160a01b0390911681526020016100bc565b610140610174366004610c17565b6105d4565b61018c610187366004610a77565b6107d4565b6040516100bc989796959493929190610cdc565b6101406101ae3660046109e7565b6108c6565b6001600160a01b03811660009081526003602090815260409182902080548351818402810184019094528084526060939283018282801561021357602002820191906000526020600020905b8154815260200190600101908083116101ff575b50505050509050919050565b6003602052816000526040600020818154811061023b57600080fd5b90600052602060002001600091509150505481565b610258610986565b6001828154811061026b5761026b610d3d565b906000526020600020906007020160405180610100016040529081600082015481526020016001820160009054906101000a900460ff1660048111156102b3576102b3610a90565b60048111156102c4576102c4610a90565b815260018201546001600160a01b036101009091048116602083015260028301541660408201526003820154606082015260048201805460809092019161030a90610d53565b80601f016020809104026020016040519081016040528092919081815260200182805461033690610d53565b80156103835780601f1061035857610100808354040283529160200191610383565b820191906000526020600020905b81548152906001019060200180831161036657829003601f168201915b5050509183525050600582015460ff16602082015260069091015460409091015292915050565b60015460609060008184116103bf57836103c1565b815b905060008167ffffffffffffffff8111156103de576103de610d8d565b60405190808252806020026020018201604052801561041757816020015b610404610986565b8152602001906001900390816103fc5790505b50905060005b828110156105b7576001816104328587610db9565b61043c9190610dd2565b8154811061044c5761044c610d3d565b906000526020600020906007020160405180610100016040529081600082015481526020016001820160009054906101000a900460ff16600481111561049457610494610a90565b60048111156104a5576104a5610a90565b815260018201546001600160a01b03610100909104811660208301526002830154166040820152600382015460608201526004820180546080909201916104eb90610d53565b80601f016020809104026020016040519081016040528092919081815260200182805461051790610d53565b80156105645780601f1061053957610100808354040283529160200191610564565b820191906000526020600020905b81548152906001019060200180831161054757829003601f168201915b5050509183525050600582015460ff166020820152600690910154604090910152825183908390811061059957610599610d3d565b602002602001018190525080806105af90610de5565b91505061041d565b50949350505050565b6105c8610909565b6105d26000610936565b565b6105dc610909565b60028054600091826105ed83610de5565b91905055905060016040518061010001604052808381526020018a600481111561061957610619610a90565b8152602001896001600160a01b03168152602001886001600160a01b0316815260200187815260200186868080601f016020809104026020016040519081016040528093929190818152602001838380828437600092018290525093855250505060ff861660208084019190915242604090930192909252835460018181018655948252908290208351600790920201908155908201518184018054939492939192909160ff1916908360048111156106d4576106d4610a90565b02179055506040820151600182018054610100600160a81b0319166101006001600160a01b039384160217905560608301516002830180546001600160a01b031916919092161790556080820151600382015560a0820151600482019061073b9082610e4d565b5060c082015160058201805460ff191660ff90921691909117905560e0909101516006909101556001600160a01b0387166000818152600360209081526040808320805460018101825590845291909220018390555182907f20ed4c16c30ac895f8edf1b9685d2fdc71502e0f22025e20be09bdee0da5c92a906107c2908c908790610f0d565b60405180910390a35050505050505050565b600181815481106107e457600080fd5b60009182526020909120600790910201805460018201546002830154600384015460048501805494965060ff8416956101009094046001600160a01b0390811695931693919261083390610d53565b80601f016020809104026020016040519081016040528092919081815260200182805461085f90610d53565b80156108ac5780601f10610881576101008083540402835291602001916108ac565b820191906000526020600020905b81548152906001019060200180831161088f57829003601f168201915b505050506005830154600690930154919260ff1691905088565b6108ce610909565b6001600160a01b0381166108fd57604051631e4fbdf760e01b8152600060048201526024015b60405180910390fd5b61090681610936565b50565b6000546001600160a01b031633146105d25760405163118cdaa760e01b81523360048201526024016108f4565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b604080516101008101909152600080825260208201908152600060208201819052604082018190526060808301829052608083015260a0820181905260c09091015290565b80356001600160a01b03811681146109e257600080fd5b919050565b6000602082840312156109f957600080fd5b610a02826109cb565b9392505050565b6020808252825182820181905260009190848201906040850190845b81811015610a4157835183529284019291840191600101610a25565b50909695505050505050565b60008060408385031215610a6057600080fd5b610a69836109cb565b946020939093013593505050565b600060208284031215610a8957600080fd5b5035919050565b634e487b7160e01b600052602160045260246000fd5b60058110610ac457634e487b7160e01b600052602160045260246000fd5b9052565b6000815180845260005b81811015610aee57602081850181015186830182015201610ad2565b506000602082860101526020601f19601f83011685010191505092915050565b6000610100825184526020830151610b296020860182610aa6565b50604083015160018060a01b03808216604087015280606086015116606087015250506080830151608085015260a08301518160a0860152610b6d82860182610ac8565b91505060ff60c08401511660c085015260e083015160e08501528091505092915050565b602081526000610a026020830184610b0e565b6000602080830181845280855180835260408601915060408160051b870101925083870160005b82811015610bf957603f19888603018452610be7858351610b0e565b94509285019290850190600101610bcb565b5092979650505050505050565b803560ff811681146109e257600080fd5b600080600080600080600060c0888a031215610c3257600080fd5b873560058110610c4157600080fd5b9650610c4f602089016109cb565b9550610c5d604089016109cb565b945060608801359350608088013567ffffffffffffffff80821115610c8157600080fd5b818a0191508a601f830112610c9557600080fd5b813581811115610ca457600080fd5b8b6020828501011115610cb657600080fd5b602083019550809450505050610cce60a08901610c06565b905092959891949750929550565b60006101008a8352610cf1602084018b610aa6565b6001600160a01b038981166040850152881660608401526080830187905260a08301819052610d2281840187610ac8565b60ff9590951660c0840152505060e001529695505050505050565b634e487b7160e01b600052603260045260246000fd5b600181811c90821680610d6757607f821691505b602082108103610d8757634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052604160045260246000fd5b634e487b7160e01b600052601160045260246000fd5b81810381811115610dcc57610dcc610da3565b92915050565b80820180821115610dcc57610dcc610da3565b600060018201610df757610df7610da3565b5060010190565b601f821115610e4857600081815260208120601f850160051c81016020861015610e255750805b601f850160051c820191505b81811015610e4457828155600101610e31565b5050505b505050565b815167ffffffffffffffff811115610e6757610e67610d8d565b610e7b81610e758454610d53565b84610dfe565b602080601f831160018114610eb05760008415610e985750858301515b600019600386901b1c1916600185901b178555610e44565b600085815260208120601f198616915b82811015610edf57888601518255948401946001909101908401610ec0565b5085821015610efd5787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b60408101610f1b8285610aa6565b60ff83166020830152939250505056fea2646970667358221220a6d877e7f8ac9bd16c0b8c9c31fa0ca854a2e8e391fc74af2581531869ee048864736f6c63430008140033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100a95760003560e01c8063715018a611610071578063715018a61461013857806371be2e4a146101425780638da5cb5b1461014b578063a138e38f14610166578063f22ac6f114610179578063f2fde38b146101a057600080fd5b806361606940146100ae578063649ad632146100c5578063680294eb146100e55780636d1884e0146100f857806370e9e62314610118575b600080fd5b6001545b6040519081526020015b60405180910390f35b6100d86100d33660046109e7565b6101b3565b6040516100bc9190610a09565b6100b26100f3366004610a4d565b61021f565b61010b610106366004610a77565b610250565b6040516100bc9190610b91565b61012b610126366004610a77565b6103aa565b6040516100bc9190610ba4565b6101406105c0565b005b6100b260025481565b6000546040516001600160a01b0390911681526020016100bc565b610140610174366004610c17565b6105d4565b61018c610187366004610a77565b6107d4565b6040516100bc989796959493929190610cdc565b6101406101ae3660046109e7565b6108c6565b6001600160a01b03811660009081526003602090815260409182902080548351818402810184019094528084526060939283018282801561021357602002820191906000526020600020905b8154815260200190600101908083116101ff575b50505050509050919050565b6003602052816000526040600020818154811061023b57600080fd5b90600052602060002001600091509150505481565b610258610986565b6001828154811061026b5761026b610d3d565b906000526020600020906007020160405180610100016040529081600082015481526020016001820160009054906101000a900460ff1660048111156102b3576102b3610a90565b60048111156102c4576102c4610a90565b815260018201546001600160a01b036101009091048116602083015260028301541660408201526003820154606082015260048201805460809092019161030a90610d53565b80601f016020809104026020016040519081016040528092919081815260200182805461033690610d53565b80156103835780601f1061035857610100808354040283529160200191610383565b820191906000526020600020905b81548152906001019060200180831161036657829003601f168201915b5050509183525050600582015460ff16602082015260069091015460409091015292915050565b60015460609060008184116103bf57836103c1565b815b905060008167ffffffffffffffff8111156103de576103de610d8d565b60405190808252806020026020018201604052801561041757816020015b610404610986565b8152602001906001900390816103fc5790505b50905060005b828110156105b7576001816104328587610db9565b61043c9190610dd2565b8154811061044c5761044c610d3d565b906000526020600020906007020160405180610100016040529081600082015481526020016001820160009054906101000a900460ff16600481111561049457610494610a90565b60048111156104a5576104a5610a90565b815260018201546001600160a01b03610100909104811660208301526002830154166040820152600382015460608201526004820180546080909201916104eb90610d53565b80601f016020809104026020016040519081016040528092919081815260200182805461051790610d53565b80156105645780601f1061053957610100808354040283529160200191610564565b820191906000526020600020905b81548152906001019060200180831161054757829003601f168201915b5050509183525050600582015460ff166020820152600690910154604090910152825183908390811061059957610599610d3d565b602002602001018190525080806105af90610de5565b91505061041d565b50949350505050565b6105c8610909565b6105d26000610936565b565b6105dc610909565b60028054600091826105ed83610de5565b91905055905060016040518061010001604052808381526020018a600481111561061957610619610a90565b8152602001896001600160a01b03168152602001886001600160a01b0316815260200187815260200186868080601f016020809104026020016040519081016040528093929190818152602001838380828437600092018290525093855250505060ff861660208084019190915242604090930192909252835460018181018655948252908290208351600790920201908155908201518184018054939492939192909160ff1916908360048111156106d4576106d4610a90565b02179055506040820151600182018054610100600160a81b0319166101006001600160a01b039384160217905560608301516002830180546001600160a01b031916919092161790556080820151600382015560a0820151600482019061073b9082610e4d565b5060c082015160058201805460ff191660ff90921691909117905560e0909101516006909101556001600160a01b0387166000818152600360209081526040808320805460018101825590845291909220018390555182907f20ed4c16c30ac895f8edf1b9685d2fdc71502e0f22025e20be09bdee0da5c92a906107c2908c908790610f0d565b60405180910390a35050505050505050565b600181815481106107e457600080fd5b60009182526020909120600790910201805460018201546002830154600384015460048501805494965060ff8416956101009094046001600160a01b0390811695931693919261083390610d53565b80601f016020809104026020016040519081016040528092919081815260200182805461085f90610d53565b80156108ac5780601f10610881576101008083540402835291602001916108ac565b820191906000526020600020905b81548152906001019060200180831161088f57829003601f168201915b505050506005830154600690930154919260ff1691905088565b6108ce610909565b6001600160a01b0381166108fd57604051631e4fbdf760e01b8152600060048201526024015b60405180910390fd5b61090681610936565b50565b6000546001600160a01b031633146105d25760405163118cdaa760e01b81523360048201526024016108f4565b600080546001600160a01b038381166001600160a01b0319831681178455604051919092169283917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e09190a35050565b604080516101008101909152600080825260208201908152600060208201819052604082018190526060808301829052608083015260a0820181905260c09091015290565b80356001600160a01b03811681146109e257600080fd5b919050565b6000602082840312156109f957600080fd5b610a02826109cb565b9392505050565b6020808252825182820181905260009190848201906040850190845b81811015610a4157835183529284019291840191600101610a25565b50909695505050505050565b60008060408385031215610a6057600080fd5b610a69836109cb565b946020939093013593505050565b600060208284031215610a8957600080fd5b5035919050565b634e487b7160e01b600052602160045260246000fd5b60058110610ac457634e487b7160e01b600052602160045260246000fd5b9052565b6000815180845260005b81811015610aee57602081850181015186830182015201610ad2565b506000602082860101526020601f19601f83011685010191505092915050565b6000610100825184526020830151610b296020860182610aa6565b50604083015160018060a01b03808216604087015280606086015116606087015250506080830151608085015260a08301518160a0860152610b6d82860182610ac8565b91505060ff60c08401511660c085015260e083015160e08501528091505092915050565b602081526000610a026020830184610b0e565b6000602080830181845280855180835260408601915060408160051b870101925083870160005b82811015610bf957603f19888603018452610be7858351610b0e565b94509285019290850190600101610bcb565b5092979650505050505050565b803560ff811681146109e257600080fd5b600080600080600080600060c0888a031215610c3257600080fd5b873560058110610c4157600080fd5b9650610c4f602089016109cb565b9550610c5d604089016109cb565b945060608801359350608088013567ffffffffffffffff80821115610c8157600080fd5b818a0191508a601f830112610c9557600080fd5b813581811115610ca457600080fd5b8b6020828501011115610cb657600080fd5b602083019550809450505050610cce60a08901610c06565b905092959891949750929550565b60006101008a8352610cf1602084018b610aa6565b6001600160a01b038981166040850152881660608401526080830187905260a08301819052610d2281840187610ac8565b60ff9590951660c0840152505060e001529695505050505050565b634e487b7160e01b600052603260045260246000fd5b600181811c90821680610d6757607f821691505b602082108103610d8757634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052604160045260246000fd5b634e487b7160e01b600052601160045260246000fd5b81810381811115610dcc57610dcc610da3565b92915050565b80820180821115610dcc57610dcc610da3565b600060018201610df757610df7610da3565b5060010190565b601f821115610e4857600081815260208120601f850160051c81016020861015610e255750805b601f850160051c820191505b81811015610e4457828155600101610e31565b5050505b505050565b815167ffffffffffffffff811115610e6757610e67610d8d565b610e7b81610e758454610d53565b84610dfe565b602080601f831160018114610eb05760008415610e985750858301515b600019600386901b1c1916600185901b178555610e44565b600085815260208120601f198616915b82811015610edf57888601518255948401946001909101908401610ec0565b5085821015610efd5787850151600019600388901b60f8161c191681555b5050505050600190811b01905550565b60408101610f1b8285610aa6565b60ff83166020830152939250505056fea2646970667358221220a6d877e7f8ac9bd16c0b8c9c31fa0ca854a2e8e391fc74af2581531869ee048864736f6c63430008140033",
  "linkReferences": {},
  "deployedLinkReferences": {}
}
